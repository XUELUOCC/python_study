<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
</head>
<body>
    <script>
        /*
            python：一门解释型，面向对象的高级编程语言
                    优点：易维护，可移植
                    缺点：运行速度慢，代码不能加密(发布代码就是发布源代码)
                    应用场景：web开发(Django，TurboGears,web2py，Flask框架)，自动化脚本(自动化测试，服务器运维)，桌面软件
                             游戏(编写游戏的逻辑和服务器)，科学计算，编写服务器软件/网络爬虫
            1.使用
                ---安装
                    --官网下载（注意点击Add的选项，添加到本地环境变量中）
                    --测试版本（cmd中输入python，可进入python环境，输入exit()退出python环境）
                
                ---vscode编译python
                    下载python（代码提示，调试），Pyright（检查python的数据类型检查，能帮助提前发现语法错误）插件，

                ---初始代码
                    --- import this -----python之禅
                    --- print("python程序") ----输出

                ---代码文件，后缀是  .py

                ---终端执行(运行的是shell脚本)
                    python 文件名
                    ---终端输入python，会进入python命令行，此时只能运行python代码，不能运行shell命令

            2.python模板
                创建py文件时，自动生成模板
                #-*- codeing = utf-8 -*-     //添加注释，说明任何编译器都是输出utf-8格式
                '''
                #@Time: ${DATA} ${TIME}      //添加注释，说明此程序生成的时间
                #@Author:cc                  //添加注释，说明此程序的作者
                #@File: ${NAME}.py           //添加注释，说明文件的拓展名和后缀
                '''
                ----单行注释  #
                ----多行注释 '''

            3.python语法
                变量：（必须是大小写字母，数字和下划线_的组合，且不能以数字开头）
                    --可以是任意的数据类型，不存在声明
                        >>a=12   #整数类型
                        >>a='asdf'  #字符串类型

                关键字：标识符
                    --and if else  等

                python的分号;
                    --也支持分号; 但可省略，更推荐使用换行符作为每条语句的分隔

                自增自减：
                    python不支持类似i++/i--的自增运算符
                    自增： i+=1;
                    自减： i-=1;

                占位符：
                    %s:说明是string
                    %d:说明是number

                输出：print()
                    >>print('www','baidu','com',sep='.')  //输出www.baidu.com的超链接sep声明中间使用.
                    >>print('hello',end='/n')  //表示最后输出后进行换行

                字符串/变量拼接:(c语言的拼接语法，先声明变量类型，再写入变量数据)
                    >>string='aaa'
                    >>string1='bbb'
                    >>print('字符串是%s'%(string))
                    >>print('字符串1是%s,字符串2是%s'%(string,string1))
                    >>print('字符串是'，string)

                输入：input()---返回结果是字符串
                    --获取用户的输入信息
                    >>password=input('请输入密码')
                    >>print('密码是',password)

                检查变量类型：type()
                    --检查变量的类型
                    >>a='123'
                    >>print(type(a))

                逻辑运算符
                    --and  与
                    --or   或
                    --not  非

                判断语句:
                    --在代码块中通过前面的空格缩进方式判断代码是属于哪一个代码段的，即是哪一对的
                    --由于 python 并不支持 switch 语句，所以多个条件判断，只能用 elif 来实现
                    --if else 
                        --等于js中的if(){

                        }else{

                        }
                        --python
                            if():
                                print()
                            else :
                                print()
                    --if elif else
                        --等于js中的if(){

                        }else if(){

                        }else{

                        }
                        --python
                            if (xxx):
                                print()
                            elif (xxx) :
                                print()
                            else:
                                print
                    >>if 100:
                    >>   print('True')
                    >>else:
                    >>   print("false")
                    >>print('end')  //此代码片段不是if-else里面的

                引入：
                    全部引入：
                        --import  xxx
                    从某个模块引入某个函数等（引入多个，使用函数名枚举排列）
                        --from xxx import test1函数名,test//函数名
                    >>import random
                    >>print()

                循环语句：Python 提供了 for 循环和 while 循环（在 Python 中没有 do..while 循环）
                        --循环中可通过break跳出循环
                    --while循环
                        while (a<10):
                            a+=1;
                            print(a)

                    --for循环
                        for i in arr:
                            print(i)

                    --for-else循环
                        --else语句是在for循环完成时执行
                        for i in arr:
                            print(i)
                        else:
                            print('aaaaa')

                    --break语句
                        for i in arr:
                            if(i<10):
                                print('小于10')
                                break
                            print(i)

                    --continue语句
                        --跳出本次循环，用来告诉Python跳过当前循环的剩余语句，然后继续进行下一轮循环。
                        --continue语句用在while和for循环中。
                    
                    --可支持双重循环
                        for-for循环
                        while-while循环

                pass语句：
                    --只起到占据语句的作用
                    --空语句
                    --可使用场景
                        --保证程序结构的完整性
                        --书写一个空函数，可使用pass保证函数正常运行
                        
            4.python数据类型
                --类型转换
                    int()--- 转换成整数
                    float()--浮点数
                    long()---长整数（ 无限大小的整数，整数最后是一个大写或小写的L。）
                    str()----对象x => 字符串
                    tuple()--序列 => 元组
                    list()---序列 => 列表
                    chr()----将一个整数 => 一个字符
                    ord()----将一个字符 => 对应的整数值

                --number类型
                    引入math模块
                        --import math/cmath
                        --print(math.sqrt(-1))
                
                --字符串

                --序列（与数组类似）--list
                    --[1,2,3,4]
                    --取序列的n位元素
                        --list[0:n]----取0到n位元素，不包括n
                        --list[0:n]----如果第一个索引是0,可以省略----list[:n]
                        --list[-1]-----取倒数第一位
                        --list[-2,-1]-----取倒数第二位和倒数第一位之间的元素
                    --方法：
                        list.append(obj)----序列末尾追加新的对象
                        list.count(obj)-----统计某元素在序列中出现的次数
                        list.index(obj)-----找出该元素在序列中第一次出现的索引值
                        list.insert(index,obj)-----将对象插入列表,改变原序列
                        list.pop(index)-----无参数,默认删除最后一个。加参数，指定删除
                    --序列长度
                        --len(list)
                    --序列最大值
                        --max(list)
                    --序列最小值
                        --min(list)
                    --序列转化成元组
                        --tuple(list)

                --元组--tuple
                    --（1,2,3）
                    --元组的数据不能修改,即tuple的每个元素的指向不变，如果tuple找那个存在序列list,
                        序列list中的数值可以发生改变，但整个元组tuple的元素指向并没有发生变化
                    --元组中只包含一个元素时，需要在元素后面添加逗号
                        --(1,)
                    --元组长度
                        --len(arr)
                    --元组最大值
                        --max(arr)
                    --元组最小值
                        --min(arr)

                --字典--dict
                    --Python内置了字典：dict的支持，dict全称dictionary，在其他语言中也称为map，
                        使用键-值（key-value）存储，具有极快的查找速度。
                    --应用场景：根据key值查找value,需要查找的时候
                    --{'user':cc,'name':ss}
                    --方法
                        --get(key,value)    //判断key是否存在，不存在返回none,或者指定的value值
                            --d.get('user')   //返回none
                            --d.get('user',-1)  //返回-1

                        --pop(key)    //删除字典中的key值
                            --d.pop('user')

                --set
                    ---与dict字典类似，同样是一组key的组合
                    ---{1,2,3}
                    ---其中set中不存在重复的key，和dict字典不同
                    ---重复元素在set中自动被过滤
                        ---s=set([1,1,2,12,33,2])
                        ---返回{1,2,12,33}
                    ---方法
                        创建set
                            --set(list列表)    //创建set
                            --set([1,2,3,4])   
                        添加key
                            --add(key)
                            --s={1,2,3}
                            --s.add(4)    
                            --print(s)    //s={1,2,3,4}
                        删除key
                            --remove(key)
                            --s={1,2,3,4,5}
                            --s.remove(1)   
                            --print(s)    //s={2,3,4,5}
                        替换key
                            --replace（被替换的key，需要成的key
                            --s={2,4,5,25,"a"}
                            --s.replace('a','A')
                            --print(s)   //s={2,4,5,25,'A'}
                        

            5.python的函数  
                --代码块以def关键字开头，函数最后以return[表达式] 结束函数，无表达式return none
                --def test(a,b):
                        return a+b
                --调用
                    test()

            6.导入模块
                --from...
                    --import test//模块名
                    --模块使用
                        --test.nameFunction() //调用test模块的方法nameFunction()

                --from...import //从模块中导入一个指定的部分到当前命名空间
                    --from test from func1  //引入test模块的fuunc1 

            7.文件操作
                --打开文件
                    f=open('test.txt','w')
                    //打开文件后，一定要关闭f.close(),无论是否打开出错，都必须关闭，以确保下次打开此文件可正常执行
                    f=open('文件名','文件模式')
                        文件模式;
                            r 只读 
                            w 只写(当是只写入时，如果查找文件不存在将会在当前目录下新建文件)
                            a 打开文件用于追加，文件存在则追加到文件的末尾，不存在则新建文件
                            rb 用二进制格式打开文件只用于只读，文件指针会放在文件的开头(这是默认模式)
                            wb 用二进制格式打开文件只用于只写，如果该文件存在则将其覆盖，不存在就会新建文件
                            ab 用二进制格式打开文件用于追加，文件存在将会追加到文件的末尾，不存在则创建新的文件
                --关闭文件
                    f.close() //关闭文件

                --写入文件内容
                    f.write('文件内容')

                --读取文件内容（一部分）
                    f.read(5)  //默认是：读取文件的从头开始的5个字符
                                //一般以上一次读取文件的末尾为起点（每执行一次，向后移动指定字符数）
                    例如：content=f.read(2)
                        print(content)  //输出2个字符
                        content=f.read(3)
                        print(content)  //输出5个字符

                --读取整个文件内容
                    content=f.readLines()
                    print(content)   //返回一个序列list,以文件内容的每一行作为元素
        
            8.异常处理
                --捕获异常
                    try/except/finally语句
                    try: 
                        //监听代码
                        print('test')
                    except Exception as result:
                        //捕获异常
                        print('产生错误')
                    finally:
                        //位置无论写在哪里都可以
                        //无论是否捕获到异常，都会执行
                        print('aaa')

            9.python爬虫
                --本质：模拟浏览器的操作，打开网页，获取网页中我们想要的数据
                --搜索引擎
                    ：本质是通过爬虫程序将网页中的数据爬取下来，保存在临时的库、数据库中进行处理
                        （如果出现新的网页数据或者没爬取完，将重复爬取的操作）
                        然后再建立一个索引区，在索引区中进行分类，归档，排序，然后将结果反馈给用户，
                        用户进行搜索引擎查询
                --基本爬虫思路
                    --封装爬取网站的request header的值，模拟真实的请求，进行伪装

            10.安装python的库(爬虫需要的库)
                --查看python安装的模块
                    --pip list
                --查看python的内置库
                    --在/python/Lib文件目录下
                --在python安装目录下的scripts下安装
                    例如：F:\python\Scripts
                --安装bs4
                    --作用：网页解析，获取数据
                    --pip install bs4
                --安装request
                    --pip install request
                --安装re
                    --作用：正则表达式，进行文字匹配
                    --
                --安装urllib.request,urllib.error 
                    --作用：制定url，获取网页数据
                --安装xlwt
                    --作用：进行excel的操作
                --安装sqlite3
                    --作用：进行SQLite数据库操作

            11.urllib使用----爬取网页
                --urllib.request.uelopen(//需要打开的网址)-----爬取网页
                --获取一个get请求
                    response=urllib.request.urlopen('http://python.org/')
                    print(response.read().decode('utf-8'))  //通过decode('utf-8')来解析成utf-8编码格式
                --获取一个post请求
                    #将信息转化成form表单提交数据
                    data=bytes(urllib.parse.urlencode({'hello':'world'}),encoding='utf-8')  //模拟用户提交数据操作
                    response=urllib.request.urlopen('http://httpbin.org/post'，timeout=0.01[设置请求时间])
                    print(response.read().decode('utf-8'))  //通过decode('utf-8')来解析成utf-8编码格式

                --防止对方察觉到是一个爬虫
                    --伪装成浏览器访问，封装请求对象（增添和修改header等---伪装成用户请求时出现的header）
                    例如：
                        url='https://www.douban.com'
                        headers={
                            //封装header对象，伪装成、真实的浏览器
                            "User-Agent":"Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36"
                        }
                        //请求时，携带参数,封装真实的请求request
                        //urlopen()方法可以实现最基本的请求的发起，但如果要加入Headers等信息，就可以利用Request类来构造请求。
                        req=urllib.request.Request(url=url,data=data,headers=headers，method="POST")
                        response=urllib.request.urlopen(req)   //进行爬取
                        print(response.read().decode('utf-8'))
                    
            12.BeautifulSoup4(简称 bs4)的使用     
                --将复杂的HTML文档转化成一个复杂的树形结构，每个节点都是python对象，所有对象可以归纳为4种
                    --Tag   
                        --标签对象（获取html文件中的标签，获取第一个出现的标签）
                            --bs.a
                        --获取标签内容
                            --bs.a.string
                        --获取标签内的所有属性值
                            --bs.a.attrs
                        --获取标签内的单个属性值
                            --bs.a['href']   //获取a标签中的href属性
                    --NavigableString
                        --标签里面的内容对象
                        --bs.a.string
                    --BeautifulSoup
                        --整个文档对象
                        --bs=beautifulSoup(html,"html.parser")
                    --Comment
                        --是一个特殊的navigableString，输出的内容不包括注释
                --使用
                    1.引入
                    2.阅读打开文件
                        --file=open('./baidu.html','rb')
                        --html=file.read()
                    3.建立bs4的对象，并设置解析器,设置解析器解析html(爬取获取的文件数据)
                        --bs=beautifulSoup(html,"html.parser")
                        --print(bs.title)  //获取html中的第一个title标签
                        --print(bs.a)   //获取html中的第一个a标签
                    4.文档的遍历
                        查找指定标签里面的所有内容的子节点
                        --查找head标签中的内容
                            --bs.meta.contents  
                    5.文档的搜索，查找指定的标签和数据
                        --find_all
                            --字符串过滤，查找与字符串完全匹配的内容
                            t_list=bs.find_all('a')   //查找所有的a标签
                            soup.find_all('div',class_="item")  //查找div，且class="name"的对象
                        
                        --search()
                            --使用正则表达式查找
                            t_list=bs.find_all(re.compile('a'))   //查找所有符合正则表达式的对象，标签中包含a的对象
                        
                        --传入一个方法(函数)查找

                        --使用选择器查找
                            --t_list=bs.select('title')  //查找title标签的元素
                            --t_list=bs.select('.mab')   //查找class=mab的元素
                            --t_list=bs.select('#ids')   //查找id=ids的元素
                            --t_list=bs.select("a[class='sd']'"")   //查找a标签中的class=sd的元素
            
            13.正则表达式
                --在正则表达式中，被比较的字符前加“r”,不用担心转义字符的问题
                    --reg=re.match(r'^[a-z]dd$','dfvgb')
                --1.引入
                    import re
                --2.编译、创建正则表达式,返回一个Pattern对象
                    pat=re.compile('^[a-z]AA$')   //编译成功的字符，用来验证其他字符的字符串。（符合标准的字符串）
                --3.正则的方法（Pattern对象的常用方法）
                    --search()
                        ----只会找到第一个匹配的对象
                        ----判断是否匹配，如果匹配成功，返回一个 Match 对象，否则返回 None
                        pat.search('aaaAA')   //存在compile，返回Pattern对象
                    --match()
                        --判断是否匹配，如果匹配成功，返回一个 Match 对象，否则返回 None
                        pat.match('sssAA')  //存在compile，返回Pattern对象
                    --findall()
                        --查找所有符合规则的字符串
                        --reg=re.findall('^[a-z]ww$正则表达式','dfgderfg需要验证的字符串')
                    --sub()
                        --替换
                        --reg=re.sub('a','A','adfgdf')  //将a替换成A
                --4.正则的简写（不存在compile中的Pattern对象）
                    --reg=re.search('^[a-z]AAD$正则表达式','adgdsfgb需要验证的字符串')
                    --print(reg)

                    --reg=re.match('^[a-z]AAD$正则表达式','adgdsfgb需要验证的字符串')
                    --print(reg)

            14.将数据保存到excel中
                --使用xlwt库
                --适用于一般数据不多的写入
                --缺点：
                    ---该模块最大列只支持255列，超出就会报错，此时可考虑使用xlsxwriter
                    ---只支持xls文件
                --使用
                    book=xlwt.Workbook(encoding='utf-8')  #创建workbook对象
                    sheet=book.add_sheet('sheet1')  #创建工作表格
                    sheet.write(0,0,'hello')  #写入数据，第一个参数“行”，第二个参数“列”，第三个参数“写入的内容”
                    book.save('study.xls') #保存数据表 参数是文件路径

            15.将数据保存到数据库中
                --可使用sqlite3 数据库
                --python3之后默认存在加载
                --使用
                    1.引入
                        import sqlite3
                    2.创建数据库对象
                        conn=sqlite3.connect("test.db(创建的文件路径，当前文件下)")
                        c=conn.sursor()  //获取游标
                        sql='''
                            create table company
                            (id int primary key not null,
                            name text not null,
                            age int not null,
                            address char(50)
                            );
                        '''
                        //书写sql语句
                        c.excute(sql)  //执行sqly语句
                        # cursor=c.execute(sql)  #查询时可通过此获取数据库数据
                        conn.commit()   //提交数据库操作,除了”查询“不需要提交操作外，其他操作都需要
                        conn.close()    //关闭数据库

            16.设置代理ip(使用urllib)
                ---防止一定的时间中，访问爬取数据频繁，被爬取网站封掉ip
                ---使用urllib。request中的ProxyHandler方法
                  --url='https://movie.douban.com/top250?start=0'
                    headers={
                        "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/89.0.4389.114 Safari/537.36"
                    }
                    #代理ip
                    proxy_list=[
                        {"http" : "61.135.217.7:80"},
                        {"http" : "111.155.116.245:8123"},
                        {"http" : "122.114.31.177:808"},
                    ]
                    #随机抽取ip
                    proxy=random.choice(proxy_list)

                    #设置代理

                    #构建代理服务器对象
                    httpproxy_handle=urllib.request.ProxyHandler(proxy)
                    #使用代理
                    opener=urllib.request.build_opener(httpproxy_handle)
                    #封装请求header
                    request=urllib.request.Request(url=url,headers=headers)
                    response=opener.open(request).read().decode('utf-8')
                    print(response)

            17.requests的使用(urllib的进一步封装库)
                ----我们在使用python爬虫时，需要模拟发起网络请求，主要用到的库有requests库和python内置的urllib库，
                    一般建议使用requests，它是对urllib的再次封装，它们使用的主要区别：
                    requests可以直接构建常用的get和post请求并发起，urllib一般要先构建get或者post请求，然后再发起请求。
                ----使用
                    import requests

                    #设置代理ip ，其中的代理ip需要和爬取网页的协议一样，即都是http或者https，否则将会报错
                    #免费代理网站：
                    https://www.zdaye.com/FreeIPlist.html  站大爷
                    https://www.kuaidaili.com/ops/   快代理


                    proxies={
                        "https" : "https://111.23.16.250:3128"
                    }

                    response=request.get(
                        url,
                        params(//请求所带的参数),
                        header,
                        cookie,
                        proxies(代理)=proxies，
                        timeout=5(超时处理)
                    )

                    #当请求发出后，Request会基于头部对响应的编码做出有根据的推测，此时我们设置编码类型，防止出错
                    response.encoding='utf-8'  //爬取网页源代码中的charest的类型(gbk,utf-8),

                    print(response.text)   //得到的是str类型
                    print(response.content) //得到的是bytes类型，需要进行解码Response_get.content.decode(),相当于Response_get.text
                    print(responose.json()) //得到的是json类数据

            18.通过selenium模拟浏览器爬取
                ----可解决通过requests爬取的网页源代码和f12看到的页面代码不一致的问题
                ----网页代码=源代码+f通过浏览器加载的数据
                ----使用
                    1.安装
                        --pip install selenium
                    2.安装chromedriver
                        --在官网中选定与浏览器对应的版本（基本与浏览器版本相同，前三位相同即可）
                            --chromedriver的版本：90.0.4430.24/      
                            --chrome的版本： 90.0.4430.93
                        --同时设置chromedriver的系统环境变量
                        --版本不相同则程序运行时出错
                    3.程序




            19.xlsxwriter的使用
                --将数据保存到excel中，但比xlwt库功能更加丰富和稳定
                --适用于大量数据的写入,
                    --不存在最大列的说法（xlwt最大列只支持255列，超出就会报错）
                    --支持xls，xlsx
                --使用
                    import xlsxwriter

                    book=xlsxwriter.Workbook('小说.xlsx')  #创建excel文件，参数是存储路径path
                    sheet=book.add_worksheet('test-sheet')   #创建工作表格对象

                    sheet.write(0,0,'内容')  #写入内容，参数（行，列，内容）
                    sheet.set_column(0,1,40) # 设置列宽(参数：start列--last列之间的列宽是多少) 起始下标为0

                    book.close() #关闭excel文件



        */

    </script>
    <div>标签</div>
    <a href="https://www.baidu.com">百度一下</a>
</body>
</html>